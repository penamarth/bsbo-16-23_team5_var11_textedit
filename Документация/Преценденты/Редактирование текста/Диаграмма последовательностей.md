# Диаграмма последовательностей для редактировования текста

```mermaid
sequenceDiagram
    actor User
    participant Editor
    participant DocxDocument
    participant Cursor
    participant Character

    User->>Editor: inputText(text)
    Editor->>DocxDocument: inputText(text)
    DocxDocument->>Cursor: getPosition()
    Cursor-->>DocxDocument: position
    loop for each char in text
        DocxDocument->>Character: new Character(char, position)
        Character-->>DocxDocument: Character instance
        DocxDocument->>DocxDocument: add to characters
        DocxDocument->>Cursor: move(1)
        Cursor-->>DocxDocument: new position
    end

    User->>Editor: setCursorPosition(position)
    Editor->>Cursor: setPosition(position)
    Cursor-->>Editor: position set

    User->>Editor: insertChar(char)
    Editor->>DocxDocument: insertChar(character)
    DocxDocument->>Cursor: getPosition()
    Cursor-->>DocxDocument: position
    DocxDocument->>Character: new Character(char, position)
    Character-->>DocxDocument: Character instance
    DocxDocument->>DocxDocument: insert to characters at position
    DocxDocument->>Cursor: move(1)
    Cursor-->>DocxDocument: new position

    User->>Editor: deleteText()
    Editor->>Cursor: getPosition()
    Cursor-->>Editor: position
    Editor->>DocxDocument: deleteText(cursor)
    DocxDocument->>DocxDocument: remove Character at cursor.position

    User->>Editor: copyText(start, end)
    Editor->>DocxDocument: copyText(start, end)
    DocxDocument->>DocxDocument: extract text from characters[start:end]
    DocxDocument-->>DocxDocument: store in copy_text

    User->>Editor: pasteText()
    Editor->>DocxDocument: pasteText(cursor)
    DocxDocument->>Cursor: getPosition()
    Cursor-->>DocxDocument: position
    loop for each char in copy_text
        DocxDocument->>Character: new Character(char, position)
        Character-->>DocxDocument: Character instance
        DocxDocument->>DocxDocument: insert to characters at position
        DocxDocument->>Cursor: move(1)
        Cursor-->>DocxDocument: new position
    end
```
